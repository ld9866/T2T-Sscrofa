# Quartet_telemore
python3 /home/lidong/Software/quarTeT-1.2.5/quartet.py TeloExplorer -i tabasco.t2t.fa -c animal -p tabasco.tel &

# Kmer
conda activate merqury
meryl k=21 count tabasco.hifi.fastq.gz output tabasco.hifi.kmer_db threads=128
merqury.sh tabasco.hifi.kmer_db tabasco.t2t.fa tabasco.t2t.merqury

# Mapping ratio
minimap2 -ax map-hifi -t 64 tabasco.fa tabascp.hifi.fastq.gz | samtools sort -m 4G -@ 16 -O bam -o tabascp.hifi.bam && samtools index tabascp.hifi.bam 
minimap2 -ax map-ont -t 128 tabasco.fa tabasco.ont.fastq.gz | samtools sort -m 4G -@ 16 -O bam -o tabasco.ont.bam && samtools index tabasco.ont.bam
# translate to bam
samtools view -@ 32 -Sb tabasco_HiC.fastq.gz.sam | \
samtools sort -@ 32 -m 4G -o tabasco_HiC_sorted.bam && \
samtools index -@ 32 tabasco_HiC_sorted.bam
# depth
/home/lidong/Software/PanDepth-2.25-Linux-x86_64/pandepth -i tabasco.hifi.bam -w 100000 -o tabasco.hifi.bam.depth &
/home/lidong/Software/PanDepth-2.25-Linux-x86_64/pandepth -i tabasco.ont.bam -w 100000 -o tabasco.ont.bam.depth &
/home/lidong/Software/PanDepth-2.25-Linux-x86_64/pandepth -i tabasco.hic.bam -w 100000 -o tabasco.hic.bam.depth &

# Methylation detection
/home/lidong/Software/dist_modkit_v0.5.0_5120ef7/modkit pileup \
  --reference tabasco.t2t.no.Y.MT.fa \
  --threads 64 \
  --cpg \
  --combine-strands \
  merged.hifi_reads.aligned.bam \
  methylation_cpg.bed
# Quality control with threshold 0.5
awk '$11 > 50' methylation_cpg.bed > methylation_cpg.0.5.bed
# Extract first three columns
cut -f 1,3 methylation_cpg.0.5.bed > summary.bed
